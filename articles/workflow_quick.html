<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="easysurv">
<title>Quick Start Guide for Survival Curve Extrapolation • easysurv</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start Guide for Survival Curve Extrapolation">
<meta property="og:description" content="easysurv">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">easysurv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_quick.html">Quick Start Guide for Survival Curve Extrapolation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Maple-Health-Group/easysurv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quick Start Guide for Survival Curve Extrapolation</h1>
                        <h4 data-toc-skip class="author">Niall Davison
&amp; Brad Kievit</h4>
            
            <h4 data-toc-skip class="date">2023-11-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Maple-Health-Group/easysurv/blob/HEAD/vignettes/workflow_quick.Rmd" class="external-link"><code>vignettes/workflow_quick.Rmd</code></a></small>
      <div class="d-none name"><code>workflow_quick.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to <code>easysurv</code>, an R package developed by the Maple
Health Group to support basic survival analysis.</p>
<p>The package helps to plot Kaplan-Meier data, assess the proportional
hazards assumptions, and estimate &amp; inspect standard parametric
survival extrapolations. <code>easysurv</code> can also assist in
mixture cure and spline modelling, although these are not explained in
detail here.</p>
<p>This guide covers the <em><code>quick</code></em> family of functions
(<code>quick_start</code>, <code>quick_KM</code>, <code>quick_PH</code>,
<code>quick_fit</code>, <code>quick_to_XL</code>) for easy survival
analysis in just a few steps. For finer control, explore other package
functions in the <em>Survival Curve Extrapolation with easysurv</em>
vignette.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Clean the R environment</strong> to ensure there’s no
interference from pre-existing R objects or functions.</li>
<li>
<strong>Attach easysurv</strong> so we can use its functions.</li>
<li>
<strong>Load a template</strong> using the
<code><a href="../reference/quick_start.html">quick_start()</a></code> function.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start from a clean environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Attach the easysurv package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Maple-Health-Group/easysurv" class="external-link">easysurv</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load a easysurv analysis template</span></span>
<span><span class="fu"><a href="../reference/quick_start.html">quick_start</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/quick_start.html">quick_start()</a></code> creates a new .R script in your R
environment, pre-loaded with code for survival analysis using the
<code>lung</code> dataset from the <code>survival</code> package.</p>
<p>You can also explore <code><a href="../reference/quick_start2.html">quick_start2()</a></code> and
<code><a href="../reference/quick_start3.html">quick_start3()</a></code>, which use different datasets: “bc” from the
<code>flexsurv</code> package and simulated phase III breast cancer
trial data from the <code>ggsurvfit</code> package, respectively.</p>
<p>While the three templates share similarities in their analyses, the
choice of starting data sets introduces some variations, making it
beneficial to review all three templates for a comprehensive
understanding of the package’s versatility.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="preparing-your-data">Preparing Your Data<a class="anchor" aria-label="anchor" href="#preparing-your-data"></a>
</h2>
<p>You will need to import, assess, and clean your data before analysis.
Below, we advise some practices to ensure that <code>easysurv</code> can
handle your data.</p>
<div class="section level3">
<h3 id="data-import">Data Import<a class="anchor" aria-label="anchor" href="#data-import"></a>
</h3>
<p><code>easysurv</code> comes pre-loaded with a few data sets borrowed
from other packages. One of these is the <code>lung</code> data set from
the <code>survival</code> package, which is accessible by calling
<code>easy_lung</code>. We’ll store it into <code>surv_data</code> and
inspect the first few rows of the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data Import ------------------------------------------------------------------</span></span>
<span><span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">easy_lung</span></span>
<span></span>
<span><span class="co"># Inspect the first few rows to check it looks as expected.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">surv_data</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   inst      time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss</span></span>
<span><span class="co">## 1    3 10.053388      2  74   1       1       90       100     1175      NA</span></span>
<span><span class="co">## 2    3 14.948665      2  68   1       0       90        90     1225      15</span></span>
<span><span class="co">## 3    3 33.182752      1  56   1       0       90        90       NA      15</span></span>
<span><span class="co">## 4    5  6.899384      2  57   1       1       90        60     1150      11</span></span>
<span><span class="co">## 5    1 29.010267      2  60   1       0      100        90       NA       0</span></span>
<span><span class="co">## 6   12 33.577002      1  74   1       1       50        80      513       0</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Toggle the next comment to see entire data.</span></span>
<span><span class="co"># View(surv_data)</span></span></code></pre></div>
<p>When importing your own data, there are a number of functions that
can be used depending on the file format of the data. These lines of
code are available in the script and can be activated as needed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here are some packages &amp; their functions you might use to import your data:</span></span>
<span><span class="co"># - haven::read_sas() for SAS (.sas7bdat) files</span></span>
<span><span class="co"># - haven::read_dta() for Stata (.dta) files</span></span>
<span><span class="co"># - haven::read_sav() for SPSS (.sav) files</span></span>
<span><span class="co"># - readxl::read_excel() for Excel (.xls &amp; .xlsx) files</span></span>
<span><span class="co"># - readr::read_csv() for .csv files</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-manipulation">Data Manipulation<a class="anchor" aria-label="anchor" href="#data-manipulation"></a>
</h3>
<p>We’ll attach one more package, <code>dplyr</code>, for data
manipulation, and adjust number formatting using
<code>scipen</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Attach other packages for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Suppress scientific notation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></code></pre></div>
<p>The data needs to be formatted in a certain way for the survival
analysis to proceed smoothly. Don’t worry, the requirements are
straightforward! The data will need:</p>
<ol style="list-style-type: decimal">
<li>A <code>time</code> variable specifying the times to events.</li>
<li>A binary <code>event</code> column specifying whether the event was
right-censored (event = 0) or an event (event = 1).</li>
<li>Optional: A <code>strata</code> column specifying some way to
stratify the events if a comparison is of interest.</li>
</ol>
<p>Let’s apply these requirements to the <code>lung</code> dataset we
imported and stored as <code>surv_data</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv_data</span> <span class="op">&lt;-</span> <span class="va">surv_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">time</span>,</span>
<span>    event <span class="op">=</span> <span class="va">status</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    strata <span class="op">=</span> <span class="va">sex</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span><span class="st">"strata"</span>, <span class="va">as.factor</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">event</span>, <span class="va">strata</span><span class="op">)</span> <span class="co"># Optional: Just keep variables of interest</span></span></code></pre></div>
<p>We took the following steps:</p>
<ul>
<li>Left <code>time</code> as is.</li>
<li>Generated <code>event</code> variable by transforming the existing
<code>status</code> variable. <code>status</code> was coded as “1” for
censoring and “2” for events, but our package (in line with standard
survival packages) uses “0” for right-censoring and “1” for events. To
fix this, we simply subtracted 1 from <code>status</code>.</li>
<li>Generated the <code>strata</code> variable using <code>sex</code>,
later converting it to a factor.</li>
<li>Converted the dataset into a “tibble” for easier manipulation, and
optionally, removed unnecessary columns using select() from
<code>dplyr</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-labelling-and-inspection">Data Labelling and Inspection<a class="anchor" aria-label="anchor" href="#data-labelling-and-inspection"></a>
</h3>
<p>Let’s take a look at our <code>strata</code> column, to understand
the sample size of each group.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See the levels of the strata</span></span>
<span><span class="va">surv_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   strata     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1        138</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2         90</span></span></code></pre>
<p>We see that there are 138 instances of the “1” value and 90 instances
of the “2” value. Since we’re stratifying by sex, this isn’t very
helpful. Let’s then rename these levels correctly as “Male” and
“Female”.</p>
<p>We can update other labeling too.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign strata labels in a consistent order with the levels command</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">surv_data</span><span class="op">$</span><span class="va">strata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">strata_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overwrite any labels impacted by re-coding</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">surv_data</span><span class="op">$</span><span class="va">event</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"0 = Censored, 1 = Event"</span></span>
<span></span>
<span><span class="co"># Define an endpoint label which can be used in plots (if desired)</span></span>
<span><span class="va">endpoint_label</span> <span class="op">&lt;-</span> <span class="st">"Overall Survival"</span></span></code></pre></div>
<p>Our data should be ready for survival analysis now, but we want to
make sure everything is set up correctly. We can take a look at the top
few rows of our “tibble”.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure the data appears as expected.</span></span>
<span><span class="co"># A tibble prints the first 10 rows by default</span></span>
<span><span class="va">surv_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 228 × 3</span></span></span>
<span><span class="co">##     time event strata</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 10.1      1 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 14.9      1 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 33.2      0 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  6.90     1 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 29.0      1 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 33.6      0 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 10.2      1 Female</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 11.9      1 Female</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  7.16     1 Male  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  5.45     1 Male  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 218 more rows</span></span></span></code></pre>
<p>We’ll do a final sense check of sample sizes and the number of
censors/events.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See sample sizes and censor/event counts</span></span>
<span><span class="va">surv_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   strata     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Male     138</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Female    90</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">strata</span>, <span class="va">event</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">##   strata event     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Male       0    26</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Male       1   112</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Female     0    37</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Female     1    53</span></span></code></pre>
<p>This summary is more informative than before. It shows more males
than females were in the data, and that a greater proportion of females
were right censored. This could be something to be mindful of as we
proceed with the analysis.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="quick-workflow-using-easysurv">Quick Workflow Using <code>easysurv</code><a class="anchor" aria-label="anchor" href="#quick-workflow-using-easysurv"></a>
</h2>
<p>Now that our data set is properly set up, we can begin with the
<code>easysurv</code> analysis! In this <em>quick</em> workflow, most of
the heavy lifting will be done by a set of functions with the
<em><code>quick_</code></em> prefix. The first of these is the
<code>quick_KM</code> function.</p>
<div class="section level3">
<h3 id="kaplan-meier-analysis">Kaplan Meier analysis<a class="anchor" aria-label="anchor" href="#kaplan-meier-analysis"></a>
</h3>
<p>The <code>quick_KM</code> function produces an object with 5
components, containing all the of Kaplan-Meier data we might need:</p>
<ol style="list-style-type: decimal">
<li>
<strong>KM_all</strong>: A <code>survfit</code> model that includes
the whole data set (comparing across strata) using
<code>Surv(time, event) ~ as.factor(strata)</code> as the formula.</li>
<li>
<strong>KM_indiv</strong>: A set of <code>survfit</code> models for
each individual strata in the data set using
<code>Surv(time, event) ~ 1</code> as the formula.</li>
<li>
<strong>KM_stepped</strong>: A table summarizing the KM survival
over time, but presented in a “stepped” manner that is useful for
plotting in Excel.</li>
<li>
<strong>KM_plot</strong>: A plot of the Kaplan Meier curve using the
<code>easysurv</code> theme.</li>
<li>
<strong>KM_summary</strong>: Summary information for each of the
strata, which includes sample sizes, the number of events, restricted
mean survival, median survial and corresponding confidence
intervals.</li>
</ol>
<p>We’ll run this function with our <code>surv_data</code> tibble,
providing the names used for the <code>time</code>, <code>event</code>
and <code>strata</code> variables, along with a few optional arguments
that you can learn about in more detail by typing <code><a href="../reference/quick_KM.html">?quick_KM</a></code>
into your console.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KM_check</span> <span class="op">&lt;-</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_KM.html">quick_KM</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">surv_data</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>  strata <span class="op">=</span> <span class="st">"strata"</span>,</span>
<span></span>
<span>  <span class="co"># Some of the optional arguments for easysurv...</span></span>
<span>  strata_labels <span class="op">=</span> <span class="va">strata_labels</span>,</span>
<span>  add_time_0 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span></span>
<span>  <span class="co"># Some of the optional arguments for ggsurvplot...</span></span>
<span>  title <span class="op">=</span> <span class="st">"Kaplan-Meier Plot"</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="va">endpoint_label</span>,</span>
<span>  ylab <span class="op">=</span> <span class="va">endpoint_label</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Months"</span>,</span>
<span>  xscale <span class="op">=</span> <span class="fl">1</span>,       <span class="co"># display in months (original)</span></span>
<span>  break.x.by <span class="op">=</span>  <span class="fl">3</span>   <span class="co"># 3 month breaks</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">KM_check</span></span></code></pre></div>
<pre><code><span><span class="co">## The quick_KM function has produced the following outputs: </span></span>
<span><span class="co">##  - KM_all</span></span>
<span><span class="co">##  - KM_indiv</span></span>
<span><span class="co">##  - KM_stepped</span></span>
<span><span class="co">##  - KM_plot</span></span>
<span><span class="co">##  - KM_summary</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Assign the output to an object to view it in detail.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Below is the KM_summary. The KM_plot has been automatically printed. </span></span>
<span><span class="co">## </span></span></code></pre>
<p><img src="workflow_quick_files/figure-html/quick-km-1.png" width="576"></p>
<pre><code><span><span class="co">##         group records events    rmean se(rmean)    median   0.95LCL  0.95UCL</span></span>
<span><span class="co">## Male     Male     138    112 10.71324 0.7527413  8.870637  6.965092 10.18480</span></span>
<span><span class="co">## Female Female      90     53 15.13420 1.1397075 13.995893 11.433265 18.06982</span></span>
<span><span class="co">##        Median follow-up</span></span>
<span><span class="co">## Male           27.59754</span></span>
<span><span class="co">## Female         17.37988</span></span></code></pre>
<p>The <code>quick_KM</code> function works by combining uses of the
<code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code>, <code><a href="../reference/plot_KM.html">easysurv::plot_KM</a></code>,
<code><a href="../reference/summarise_KM.html">easysurv::summarise_KM</a></code> and <code><a href="../reference/step_KM.html">easysurv::step_KM</a></code>
functions.</p>
<p>We stored the output in <code>KM_check</code>. Calling KM_check gives
us a quick summary but, since it’s a list object, if we want to look at
any individual component, we need to call it by name in double square
brackets. For example,</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KM_check</span><span class="op">[[</span><span class="st">"KM_plot"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="workflow_quick_files/figure-html/KM-plot-1.png" width="576"></p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="diagnostic-tests">Diagnostic tests<a class="anchor" aria-label="anchor" href="#diagnostic-tests"></a>
</h3>
<p>Next, we want to run some diagnostics tests, which will be
informative for future curve fitting. For this, we’ll use another
consolidated function, <code><a href="../reference/quick_PH.html">quick_PH()</a></code>. The output is another
list object with five components:</p>
<ol style="list-style-type: decimal">
<li>
<strong>cloglog_plot</strong>: A log cumulative hazard plot with the
<code>easysurv</code> theme.</li>
<li>
<strong>coxph_model</strong>: A <code>summary.coxPH</code> object
containing statistical test outputs, namely the Cox PH hazard ratio and
confidence intervals.</li>
<li>
<strong>survdiff</strong>: A <code>survdiff</code> object that
summarizes a log-rank test, which tests for differences in survival
between strata. If p-values are &gt; 0.05, differences are not
statistically significant.</li>
<li>
<strong>coxzph_ph_test</strong>: A <code>summary.coxPH</code> object
containing statistical test outputs, namely around whether the data
violates the proportional hazards assumption or not.</li>
<li>
<strong>schoenfeld_plot</strong>: A Schoenfeld residuals plot in the
<code>easysurv</code> theme.</li>
</ol>
<p>We’ll run the function using <code>surv_data</code>, supplying the
mostly self-explanatory arguments. You can type <code><a href="../reference/quick_PH.html">?quick_PH</a></code>
in the console or visit the other vignette for more information.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PH_check</span> <span class="op">&lt;-</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_PH.html">quick_PH</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">surv_data</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>  strata <span class="op">=</span> <span class="st">"strata"</span>,</span>
<span>  strata_labels <span class="op">=</span> <span class="va">strata_labels</span>, <span class="co"># Optional</span></span>
<span>  subtitle <span class="op">=</span> <span class="va">endpoint_label</span> <span class="co"># Optional</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">PH_check</span></span></code></pre></div>
<pre><code><span><span class="co">## The quick_PH function has produced the following outputs: </span></span>
<span><span class="co">##  - cloglog_plot</span></span>
<span><span class="co">##  - coxph_model</span></span>
<span><span class="co">##  - survdiff</span></span>
<span><span class="co">##  - cox.zph_PH_test</span></span>
<span><span class="co">##  - schoenfeld_plot</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Assign the output to an object to view it in detail. </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---- survival::coxph output ----------------------- </span></span>
<span><span class="co">## ---- note: exp(coef) provides Hazard Ratio(s). ---- </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## survival::coxph(formula = fit_joint, data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   n= 228, number of events= 165 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 coef exp(coef) se(coef)      z Pr(&gt;|z|)   </span></span>
<span><span class="co">## strataFemale -0.5310    0.5880   0.1672 -3.176  0.00149 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span><span class="co">## strataFemale     0.588      1.701    0.4237     0.816</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Concordance= 0.579  (se = 0.021 )</span></span>
<span><span class="co">## Likelihood ratio test= 10.63  on 1 df,   p=0.001</span></span>
<span><span class="co">## Wald test            = 10.09  on 1 df,   p=0.001</span></span>
<span><span class="co">## Score (logrank) test = 10.33  on 1 df,   p=0.001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## ---- survival::survdiff output -------------------- </span></span>
<span><span class="co">## ---- note: survdiff tests for differences in ------ </span></span>
<span><span class="co">## ---------- survival between strata, using a  ------ </span></span>
<span><span class="co">## ---------- log-rank test.  ------------------------ </span></span>
<span><span class="co">## --------------------------------------------------- </span></span>
<span><span class="co">## ---------- If p-values &gt; 0.05, differences are ---- </span></span>
<span><span class="co">## ---------- not statistically significant. --------- </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## survival::survdiff(formula = fit_joint, data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">## strata=Male   138      112     91.6      4.55      10.3</span></span>
<span><span class="co">## strata=Female  90       53     73.4      5.68      10.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Chisq= 10.3  on 1 degrees of freedom, p= 0.001 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## ---- survival::cox.zph output --------------------- </span></span>
<span><span class="co">## ---- note: tests proportional hazards assumption -- </span></span>
<span><span class="co">## --------------------------------------------------- </span></span>
<span><span class="co">## -----------If p-values &gt; 0.05, do not reject ------ </span></span>
<span><span class="co">## -----------PH assumption -------------------------- </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##        chisq df     p</span></span>
<span><span class="co">## strata  2.86  1 0.091</span></span>
<span><span class="co">## GLOBAL  2.86  1 0.091</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## The log cumulative hazard and Schoenfeld residuals plots have been automatically printed.</span></span></code></pre>
<p><img src="workflow_quick_files/figure-html/quick-PH-1.png" width="576"><img src="workflow_quick_files/figure-html/quick-PH-2.png" width="576"></p>
<p>This function combines the use of <code><a href="../reference/plot_KM.html">easysurv::plot_KM</a></code> for
plotting the log cumulative hazard, <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph</a></code> and
<code><a href="https://rdrr.io/pkg/survival/man/cox.zph.html" class="external-link">survival::cox.zph</a></code> for fitting a Cox model,
<code><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survival::survdiff</a></code> for testing differences in survival, and
<code>easysurv::ggcoxdiagnostics</code> for producing a Schoenfeld
plot.</p>
<p>As with KM_check, PH_check is a list object, so individual components
can be called using double square brackets. However, the output of this
object supplies all the plots and tests in quick succession, which we
can scroll/click through as needed.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="fitting-survival-models">Fitting Survival Models<a class="anchor" aria-label="anchor" href="#fitting-survival-models"></a>
</h3>
<p>Now that we have better statistical awareness of our data, we can fit
curves to the data. Off the top, we need to decide what kind of analysis
we want to do. <code>easysurv</code> has 4 different options, and we can
choose one, some or all of them:</p>
<ul>
<li>Separate parametric model fitting</li>
<li>Joint parametric model fitting</li>
<li>Mixture cure model fitting</li>
<li>Spline model fitting</li>
</ul>
<p>Once decided, we can set our preferences. In this instance, we will
choose to do just the standard separate parametric fits.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Choose Model Fit Approaches ---------------------------------------------</span></span>
<span></span>
<span><span class="co"># After assessing the Kaplan Meier and Proportional Hazards outputs,</span></span>
<span><span class="co"># choose a set of analyses to perform.</span></span>
<span></span>
<span><span class="va">do_standard</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># TRUE: run standard parametric model fits (separate)</span></span>
<span><span class="va">do_joint</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># TRUE: run standard parametric model fits (joint)</span></span>
<span><span class="va">do_cure</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># TRUE: run mixture cure model fits</span></span>
<span><span class="va">do_splines</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># TRUE: run spline model fits</span></span></code></pre></div>
<p>We also need to select our distributions of interest. We can choose
as many or as few as we want, so long as it’s available as a dist option
in <code>flexsurvreg</code>, which is the underlying function of our
custom fitting function.</p>
<p>Here, we’re going to fit curves to “Exponential”, “Gamma”,
“Generalized Gamma”, “Gompertz”, “log-logistic”, “log-normal” and
“Weibull” distributions. With gamma as an exception, these are the
distributions recommended by NICE in Technical Support Document (TSD)
14, <a href="https://www.sheffield.ac.uk/media/34225/download?attachment" class="external-link">“Survival
analysis: Extrapolating patient data”</a>. Gamma has been included
because it has been required by other HTA bodies, including CADTH. The
notation for these distributions is defined per
<code>flexsurvreg</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dists_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"exp"</span>,</span>
<span>  <span class="st">"gamma"</span>,</span>
<span>  <span class="st">"gengamma"</span>,</span>
<span>  <span class="st">"gompertz"</span>,</span>
<span>  <span class="st">"llogis"</span>,</span>
<span>  <span class="st">"lnorm"</span>,</span>
<span>  <span class="st">"weibull"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can specify the times over which we want to generate and plot
extrapolations Here, we’ll use the <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> function to start
at time = 0 and go out to 5 times the maximum supplied survival value
from the data set. We’ll also specify that between these two times, we
want 200 equally spaced time points.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Times over which to generate/plot extrapolations</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">surv_data</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  length.out <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We are now ready to use the <em>quick_fit</em> functions, which
consolidate the entire fitting process into one step. There is one
function for each type of analysis: <code><a href="../reference/quick_fit.html">quick_fit()</a></code>,
<code><a href="../reference/quick_fit_joint.html">quick_fit_joint()</a></code>, <code><a href="../reference/quick_fit_cure.html">quick_fit_cure()</a></code> and
<code><a href="../reference/quick_fit_splines.html">quick_fit_splines()</a></code>. In this case, we will only use
<code><a href="../reference/quick_fit.html">quick_fit()</a></code> since we only want to complete a standard
separate parametric fitting. Nevertheless, the process is very similar
for the other <em>quick_fit</em> functions and you can get information
on each one by typing the name of the function, prefixed with a “?”, in
the console.</p>
<p>The script has a set of conditions set up so we don’t need to
specifically find the <em>quick_fit</em> functions we want to use and
avoid the ones we don’t. We can simply click through the whole <em>“##
Model Fitting —-”</em> section.</p>
<p>As we click through this section, we’ll execute the
<code><a href="../reference/quick_fit.html">quick_fit()</a></code> function. Of note, we supplied our times over
which we want to generate/plot extrapolations in the <code>times</code>
argument.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Separate fits --------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">do_standard</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dists</span> <span class="op">&lt;-</span> <span class="va">dists_global</span></span>
<span></span>
<span>  <span class="co"># Toggle line below to see the function help</span></span>
<span>  <span class="co"># ?quick_fit</span></span>
<span></span>
<span>  <span class="co"># Fit models</span></span>
<span>  <span class="va">fit_check</span> <span class="op">&lt;-</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_fit.html">quick_fit</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">surv_data</span>,</span>
<span>    time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>    event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>    strata <span class="op">=</span> <span class="st">"strata"</span>,</span>
<span>    dists <span class="op">=</span> <span class="va">dists</span>,</span>
<span>    <span class="co"># Optional easysurv arguments</span></span>
<span>    times <span class="op">=</span> <span class="va">times</span>,</span>
<span>    strata_labels <span class="op">=</span> <span class="va">strata_labels</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Months"</span>,</span>
<span>    add_interactive_plots <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## gompertz mean survival time not calculable.</span></span></code></pre>
<pre><code><span><span class="co">## gengamma mean survival time not calculable.</span></span></code></pre>
<p>To view the output of this object, we can continue to click through
the next section, <em>“## See Outputs —-”</em>, which are also set up
conditionally, so we don’t need to specifically find the outputs we
created and avoid the ones we didn’t.</p>
<p>As with the other <em>quick</em> objects, <code>fit_check</code> is a
list object with 9 components than can be called individually using
double square brackets:</p>
<ol style="list-style-type: decimal">
<li>
<strong>converged</strong>: A list of all the successfully converged
distributions for each strata.</li>
<li>
<strong>fits</strong>: A <code><a href="https://rdrr.io/pkg/survHE/man/fit.models.html" class="external-link">survHE::fit.models</a></code> output,
containing the <code>flexsurv</code> objects for each converged
distribution for each strata.</li>
<li>
<strong>hazard_plots</strong>: Smoothed hazard plots for each
strata.</li>
<li>
<strong>hazard_plotly</strong>: <em>If the
<code>add_interactive_plots</code> argument was set to
<code>TRUE</code>.</em> A set of interactive <code>plotly</code> hazard
plots, that can accessed in the Viewer panel of RStudio, for each
strata.</li>
<li>
<strong>fit_plots</strong>: Plots of the curve extrapolations over
the supplied times for each strata.</li>
<li>
<strong>fit_plotly</strong>: <em>If the
<code>add_interactive_plots</code> argument was set to
<code>TRUE</code>.</em> A set of interactive <code>plotly</code>
survival plots, that can accessed in the Viewer panel of RStudio, for
each strata.</li>
<li>**goodness_of_fit: AIC and BIC outputs, along with their relative
ranks for each distribution.</li>
<li>
<strong>surv_params</strong>: The <code>flexsurv</code> parameters
for each distribution and strata, along with their variance-covariance
matrices.</li>
<li>
<strong>predicted_fits</strong>: Predicted survival proportions over
the supplied times for each strata.</li>
</ol>
<p>For example, we can see a plot of our survival data alongside the
curve extrapolations by calling our newly created <code>fit_check</code>
and specifying the component of interest using double square
brackets.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_check</span><span class="op">[[</span><span class="st">"fit_plots"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Male"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="workflow_quick_files/figure-html/fit-check-1.png" width="576"></p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="exporting-results-to-excel">Exporting results to Excel<a class="anchor" aria-label="anchor" href="#exporting-results-to-excel"></a>
</h3>
<p>All of the objects created by the set of <em>quick</em> functions,
are formatted in such a way that they export easily to Excel. For those
who want to export all of these results, we can leverage the
<code>openxlsx</code> package. We’ll start by creating a new blank
workbook.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Excel Exports ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Create a new workbook object</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createWorkbook.html" class="external-link">createWorkbook</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can now use the <code>quick_to_XL</code> function to take each of
the objects created by the <em>quick</em> functions and put them in the
blank workbook. As with above, these are set up conditionally depending
on what analyses were performed, so we can simply click through this
section.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The "quick_to_XL" function prepares easysurv outputs for Excel exporting.</span></span>
<span><span class="co"># Note that plots will be reproduced at a different DPI setting for Excel.</span></span>
<span><span class="co"># This may make them appear strange in R temporarily.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">KM_check</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">PH_check</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">do_standard</span><span class="op">)</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">fit_check</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">do_joint</span><span class="op">)</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">fit_check_joint</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">do_cure</span><span class="op">)</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">fit_check_cure</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">do_splines</span><span class="op">)</span> <span class="fu">easysurv</span><span class="fu">::</span><span class="fu"><a href="../reference/quick_to_XL.html">quick_to_XL</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, quick_object <span class="op">=</span> <span class="va">fit_check_splines</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we’ll give this document a name, which is set to be
<em>“easysurv output -”</em> along with the date and time, we’ll save
the document and we’ll open it up!</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Give the workbook a name ending in .xlsx</span></span>
<span><span class="va">output_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"easysurv output - "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y-%m-%d %H.%M"</span><span class="op">)</span>,</span>
<span>  <span class="st">".xlsx"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the workbook - you can choose a directory before this if desired.</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html" class="external-link">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, file <span class="op">=</span> <span class="va">output_name</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Open the workbook and assess contents.</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/openXL.html" class="external-link">openXL</a></span><span class="op">(</span><span class="va">output_name</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>And with that, we have a set of standard parametric model outputs in
both R and Excel! Look out for future functionality and vignettes and be
sure to check out the templates produced by <code><a href="../reference/quick_start2.html">quick_start2()</a></code>
and <code><a href="../reference/quick_start3.html">quick_start3()</a></code>. If you encounter any bugs or issues,
please reach out to the authors.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Niall Davison, Brad Kievit.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
